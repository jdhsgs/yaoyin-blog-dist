(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{547:function(s,n,a){"use strict";a.r(n);var t=a(12),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一、解决中文乱码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、解决中文乱码"}},[s._v("#")]),s._v(" 一、解决中文乱码")]),s._v(" "),a("p",[s._v("如果没有安装中文字体，在截图时会出现中文不显示的问题\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210427113842913.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RvbmdHZUdlMjE0,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v("\n对于构建镜像之前\n如果使用的是 windows，可以将中文字体(C:\\Windows\\Fonts\\微软雅黑\\msyh.ttc)拷贝到 Dockerfile 所在的目录，在构建镜像时就解决中文乱码问题\n如果是按照本文指导操作，可将本文第二步的 Dockerfile 的第3行注释解开，即：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("FROM python:3.8-slim\n# 解决截图中文乱码 其他字体请自行修改字体文件名\nCOPY msyh.ttc /usr/share/fonts/ \n...\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("对于容器已存在时"),a("br"),s._v("\n可以将字体拷贝到容器"),a("code",[s._v("/usr/share/fonts/")]),s._v("目录下，也能解决中文乱码\n"),a("code",[s._v("$ docker cp msyh.ttc Container_name_or_ID:/usr/share/fonts/")])]),s._v(" "),a("h2",{attrs:{id:"二、dockfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、dockfile"}},[s._v("#")]),s._v(" 二、Dockfile")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("FROM python:3.8-slim\n# 解决截图中文乱码 其他字体请自行修改字体文件名\n# COPY msyh.ttc /usr/share/fonts/ \n\n# python:3.8-slim 是基于 Debian GNU/Linux 10 (buster) 制作的\n# 使用 Debian 清华源\n# https://mirrors.tuna.tsinghua.edu.cn/help/debian/\nRUN mv /etc/apt/sources.list /etc/apt/sources.list_bak && \\\n    echo '# 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释' >> /etc/apt/sources.list && \\\n    echo 'deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free' >> /etc/apt/sources.list && \\\n    echo '# deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free' >> /etc/apt/sources.list && \\\n    echo 'deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-updates main contrib non-free' >> /etc/apt/sources.list && \\\n    echo '# deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-updates main contrib non-free' >> /etc/apt/sources.list && \\\n    echo 'deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-backports main contrib non-free' >> /etc/apt/sources.list && \\\n    echo '# deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-backports main contrib non-free' >> /etc/apt/sources.list && \\\n    echo 'deb https://mirrors.tuna.tsinghua.edu.cn/debian-security buster/updates main contrib non-free' >> /etc/apt/sources.list && \\\n    echo '# deb-src https://mirrors.tuna.tsinghua.edu.cn/debian-security buster/updates main contrib non-free' >> /etc/apt/sources.list\n\n# 使用 Debian 清华源加速下载\nRUN apt-get update && apt-get -y install apt-transport-https ca-certificates libnss3 xvfb gconf-service libasound2 libatk1.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgbm1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca-certificates fonts-liberation libappindicator1 libnss3 lsb-release xdg-utils wget && rm -rf /var/lib/apt/lists/*\n\n# 使用淘宝镜像加速下载 chromium\nENV PYPPETEER_DOWNLOAD_HOST=https://npm.taobao.org/mirrors\n# 设置 chromium 版本，发布日期为: 2021-02-26T08:47:06.448Z\nENV PYPPETEER_CHROMIUM_REVISION=856583\n\n# 使用 pypi 清华源加速下载\nRUN pip install pyppeteer && pyppeteer-install -i https://pypi.tuna.tsinghua.edu.cn/simple\n\nCMD python\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h2",{attrs:{id:"三、构建并启动容器测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、构建并启动容器测试"}},[s._v("#")]),s._v(" 三、构建并启动容器测试")]),s._v(" "),a("ol",[a("li",[s._v("构建出镜像\n"),a("code",[s._v("$ docker build -t py-chrome .")])]),s._v(" "),a("li",[s._v("准备代码文件"),a("br"),s._v("\ndemo.py")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import asyncio\n\nimport pyppeteer\n\n\nasync def main():\n   browser = await pyppeteer.launch(\n       options={\n           'args': ['--no-sandbox']\n       }\n   )\n   page = await browser.newPage();\n   await page.setViewport({ 'width': 1920, 'height': 1080 });\n   await page.goto('https://baidu.com', {\n       'waitUntil': 'networkidle0' # 直到 http 连接为 0，即页面加载完成\n   })\n   await page.screenshot({\n       'path': 'baidu.png',\n       'fullPage': True  # 截取完整页面，否则只会截取屏幕可见大小\n   })\n   await browser.close()\n\n\nasyncio.get_event_loop().run_until_complete(main())\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("启动容器并测试")])]),s._v(" "),a("div",{staticClass:"language-$ # 如果是使用 Windows 的 cmd line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ # 将 $(pwd) 替换为 %cd% 参考 https://stackoverflow.com/a/41489151\n$ ls # 检查当前文件夹有 demo.py，否则 $(pwd) 映射到容器后，代码文件不存在\nDockerfile  baidu.png  demo.py\tmsyh.ttc\n$ docker run --name pychrome -v $(pwd):/workspace -itd py-chrome\n$ docker exec -it pychrome bash # 此时会进入到容器的shell内，用户为root\n# cd /workspace\n# python demo.py\n# ls # 此时看到 baidu.png 即为成功\nDockerfile  baidu.png  demo.py\tmsyh.ttc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("检查中文是否支持\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210427132435496.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RvbmdHZUdlMjE0,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])])])}),[],!1,null,null,null);n.default=e.exports}}]);